import{o as oe,a as le}from"./lifecycle.BUdnxebf.js";import{j as h,k as ce,l as C,f as de,t as J,g as t,a as K,p as ue,b as fe,s as i,e as n,h as d,d as N,r as o,n as V}from"./template.CPXyBZoS.js";import{s as me}from"./render.LYkq5V1R.js";import{e as pe,i as he}from"./each.DObiixEX.js";import{I as k,h as ve}from"./Icon.DOu6xpjm.js";import{a as W,s as P,r as Y}from"./props.DO61WAiE.js";import{d as be,e as x}from"./utils.nNk4BeOt.js";import{b as q}from"./input.Cqjd78kO.js";import{I as A}from"./zh_TW.B395Vq90.js";import{i as G}from"./translation.CCjw6gXK.js";import{n as ge}from"./navigation-utils.Cc6bKnia.js";import{u as H}from"./url-utils.C1uTr_Hk.js";/* empty css                        */import"./if.CsDsK0Yx.js";import"./config.dR5stsED.js";var we=N(`<a class="transition first-of-type:mt-2 lg:first-of-type:mt-0 group block
       rounded-xl text-lg px-3 py-2 hover:bg-[var(--btn-plain-bg-hover)] active:bg-[var(--btn-plain-bg-active)]"><div class="transition text-90 inline-flex font-bold group-hover:text-[var(--primary)]"> <!></div> <div class="transition text-sm text-50"><!></div></a>`),ke=N(`<div class="hidden lg:block relative w-11 h-11 shrink-0"><div id="search-bar" role="button" tabindex="0" aria-label="Search"><!> <input id="search-input-desktop"/></div></div> <button aria-label="Search Panel" id="search-switch" class="btn-plain scale-animation lg:!hidden rounded-lg w-11 h-11 active:scale-90"><!></button> <div id="search-panel" class="float-panel float-panel-closed absolute md:w-[30rem] top-20 left-4 md:left-[unset] right-4 z-50 search-panel shadow-2xl rounded-2xl p-2"><div id="search-bar-inside" class="flex relative lg:hidden transition-all items-center h-11 rounded-xl
      bg-black/[0.04] hover:bg-black/[0.06] focus-within:bg-black/[0.06]
      dark:bg-white/5 dark:hover:bg-white/10 dark:focus-within:bg-white/10
  "><!> <input class="pl-10 absolute inset-0 text-sm bg-transparent outline-0
               focus:w-60 text-black/50 dark:text-white/50 svelte-1wah7ro"/></div> <!></div>`,1);function je(O,Q){fe(Q,!0);let l=h(""),v=h(""),c=h(ce([])),y=!1,b=h(!1),s=h(!1),_,T=!1,I,B;const xe=[{url:H("/"),meta:{title:"This Is a Fake Search Result"},excerpt:"Because the search cannot work in the <mark>dev</mark> environment."},{url:H("/"),meta:{title:"If You Want to Test the Search"},excerpt:"Try running <mark>npm build && npm preview</mark> instead."}],U=()=>{document.getElementById("search-panel")?.classList.toggle("float-panel-closed")},$=()=>{T||(i(s,!t(s)),t(s)&&setTimeout(()=>{document.getElementById("search-input-desktop")?.focus()},0))},X=()=>{t(l)||i(s,!1)},Z=()=>{B=setTimeout(()=>{i(s,!1),m(!1,!0)},200)},m=(e,a)=>{const r=document.getElementById("search-panel");!r||!a||(e?r.classList.remove("float-panel-closed"):r.classList.add("float-panel-closed"))},ee=()=>{const e=document.getElementById("search-panel");e&&e.classList.add("float-panel-closed"),i(l,""),i(v,""),i(c,[],!0)},te=(e,a)=>{e.preventDefault(),ee(),ge(a)},D=async(e,a)=>{if(!e){m(!1,a),i(c,[],!0);return}if(t(b))try{let r=[];if(y&&window.pagefind){const p=await window.pagefind.search(e);r=await Promise.all(p.results.map(w=>w.data()))}else r=[],console.error("Pagefind is not available in production environment.");i(c,r,!0),m(t(c).length>0,a)}catch(r){console.error("Search error:",r),i(c,[],!0),m(!1,a)}};oe(()=>{const e=()=>{i(b,!0),y=typeof window<"u"&&!!window.pagefind&&typeof window.pagefind.search=="function",console.log("Pagefind status on init:",y)};document.addEventListener("pagefindready",()=>{console.log("Pagefind ready event received."),e()}),document.addEventListener("pagefindloaderror",()=>{console.warn("Pagefind load error event received. Search functionality will be limited."),e()}),setTimeout(()=>{t(b)||(console.log("Fallback: Initializing search after timeout."),e())},2e3);const a=()=>{T=!0,clearTimeout(I),I=setTimeout(()=>{T=!1},500)};return window.addEventListener("focus",a),()=>{window.removeEventListener("focus",a)}}),C(()=>{if(t(b)){const e=t(l)||t(v),a=!!t(l)||t(s);clearTimeout(_),e?_=setTimeout(()=>{D(e,a)},300):(i(c,[],!0),m(!1,a))}}),C(()=>{if(typeof document<"u"){const e=document.getElementById("navbar");t(s)?e?.classList.add("is-searching"):e?.classList.remove("is-searching")}}),le(()=>{typeof document<"u"&&document.getElementById("navbar")?.classList.remove("is-searching"),clearTimeout(_),clearTimeout(I)});var z=ke(),E=de(z),u=n(E);u.__click=()=>{document.getElementById("search-input-desktop")?.focus()};var F=n(u);{let e=V(()=>t(s)?"left-3":"left-1/2 -translate-x-1/2"),a=V(()=>t(s)?"text-black/30 dark:text-white/30":"");k(F,{icon:"material-symbols:search",get class(){return`absolute text-[1.25rem] pointer-events-none ${t(e)??""} transition top-1/2 -translate-y-1/2 ${t(a)??""}`}})}var f=d(F,2);Y(f),o(u),o(E);var g=d(E,2);g.__click=U;var ae=n(g);k(ae,{icon:"material-symbols:search",class:"text-[1.25rem]"}),o(g);var R=d(g,2),L=n(R),M=n(L);k(M,{icon:"material-symbols:search",class:"absolute text-[1.25rem] pointer-events-none ml-3 transition my-auto text-black/30 dark:text-white/30"});var S=d(M,2);Y(S),o(L);var re=d(L,2);pe(re,17,()=>t(c),he,(e,a)=>{var r=we();r.__click=ne=>te(ne,t(a).url);var p=n(r),w=n(p,!0),se=d(w);k(se,{icon:"fa7-solid:chevron-right",class:"transition text-[0.75rem] translate-x-1 my-auto text-[var(--primary)]"}),o(p);var j=d(p,2),ie=n(j);ve(ie,()=>t(a).excerpt),o(j),o(r),J(()=>{P(r,"href",t(a).url),me(w,t(a).meta.title)}),K(e,r)}),o(R),J((e,a)=>{W(u,1,`flex transition-all items-center h-11 rounded-lg absolute right-0 top-0 shrink-0
            ${t(s)?"bg-black/[0.04] hover:bg-black/[0.06] focus-within:bg-black/[0.06] dark:bg-white/5 dark:hover:bg-white/10 dark:focus-within:bg-white/10":"btn-plain active:scale-90"}
            ${t(s)?"w-48":"w-11"}`),P(f,"placeholder",e),W(f,1,`transition-all pl-10 text-sm bg-transparent outline-0
                h-full ${t(s)?"w-36":"w-0"} text-black/50 dark:text-white/50`,"svelte-1wah7ro"),P(S,"placeholder",a)},[()=>G(A.search),()=>G(A.search)]),x("mouseenter",u,()=>{t(s)||$()}),x("mouseleave",u,X),x("focus",f,()=>{clearTimeout(B),t(s)||$(),D(t(l),!0)}),x("blur",f,Z),q(f,()=>t(l),e=>i(l,e)),q(S,()=>t(v),e=>i(v,e)),K(O,z),ue()}be(["click"]);export{je as default};
